# 티켓 예매 시스템 도메인 모델

## 도메인

### 사용자

- 예매 시스템을 사용하기 위해 회원으로 등록되어야 한다.
    - 아이디
        - 사용자 ID와 동일한 패스워드 설정 금지
        - 동일 문자·숫자 연속 반복 입력 금지
        - 키보드상 연속 문자 4개 이상 순차 입력 금지
    - 비밀번호
        - 9자리 이상 길이
        - 숫자, 대문자, 소문자, 특수문자 각 1개 이상 포함
    - 등록 시간, 등록 완료 시간, 탈퇴 시간을 저장한다.
    - 사용자 로그인을 통해 내 예매를 확인할 수 있다.
    - 예매확인/취소는 인증된 사용자만 사용이 가능하다.
- 비회원은 티켓번호와 인증을 통해 예매한 티켓을 확인할 수 있다.

### 공연/경기

- 공연 정보를 관리한다.
    - 공연명, 공연 날짜, 공연 시간
    - 공연장 정보 (장소명, 주소)
    - **좌석 배치도 (지정석 전용)**
    - **공연 날짜별 회차 정보**
    - 카테고리 (스포츠, 콘서트, 뮤지컬 등)
    - 지역별 분류
- 공연별 예매 오픈 시간을 설정한다.
- 공연별 예매 가능 기간을 설정한다.
- 공연별 취소/환불 규정을 설정한다.

### 좌석 (지정석 전용)

- 좌석 정보를 관리한다.
    - 좌석 번호 (구역-열-번호)
    - 좌석 등급 (VIP, R, S, A 등)
    - 등급별 가격
    - 좌석 상태 (예매가능/선택중/예매완료/장애석)
- **날짜별, 회차별 좌석 상태를 관리한다.**
- 좌석 선택 시 임시 점유 시간 (10분)을 부여한다.
- 동시 선택 방지를 위한 잠금 처리를 한다.

### 예매

- 사용자는 공연을 조회 및 예매할 수 있다.
    - **날짜를 선택하여 공연을 조회한다.**
    - **선택한 날짜의 회차를 선택한다.**
    - 지역별, 카테고리별로 공연을 조회한다.
    - 공연명으로 검색할 수 있다.
- **지정석 선택 프로세스**
    1. 공연 선택 → 날짜 선택 → 회차 선택
    2. 좌석 배치도에서 원하는 좌석 선택
    3. 선택한 좌석 정보 확인 (구역, 가격)
    4. 예매자 정보 입력
    5. 결제 진행
- 예매 시 대기열 시스템을 운영한다.
    - 대기 순번 표시
    - 예상 대기 시간 안내
    - 순서 도달 시 자동 입장
- 예매 완료 시 알림을 발송한다.
    - 카카오톡 알림
    - 이메일 발송
    - 예매 번호 및 QR코드 제공

### 예매 관리

- 예매 상태를 관리한다.
    - 임시예매 (좌석 선택 완료)
    - 결제대기 (30분 이내 결제 필요)
    - 예매완료
    - 예매취소
- **날짜별 예매 현황을 관리한다.**
    - 일자별 잔여 좌석 수
    - 예매율
    - 매진 여부
- 예매 취소 규정을 적용한다.
    - 공연 7일 전: 전액 환불
    - 공연 3일 전: 50% 환불
    - 공연 1일 전: 환불 불가
- 1인당 예매 매수를 제한한다. (예: 4매)

### 결제

- 결제 수단을 제공한다.
    - 카카오페이
    - 무통장입금
    - 신용카드
- 결제 시간 제한을 둔다. (30분)
- 미결제 시 자동으로 예매를 취소한다.
- 결제 완료 내역을 저장한다.

### 부가 기능

- 공연별 랭킹 및 예매율을 표시한다.
- 공연 관람 후기와 평점을 작성할 수 있다.
- 고객센터를 운영한다.
- 개인정보 처리방침을 명시한다.
- 팝업창으로 공지사항을 안내한다.

### 보안

- 매크로/봇 방지 시스템을 적용한다.
- CAPTCHA 인증을 사용한다.
- 비정상 접근을 차단한다.

### 관리자

- 관리자는 예매를 등록할 수 있다.
- 관리자는 티켓 및 환불에 대한 정책을 설정할 수있다.
- 등록된 공연, 회원 정보, 예매 내역 등을 관리할 수 있다.
- 로그인, 로그아웃 , 사용자 등록, 변경, 삭제 , 중복 로그인 시도 탐지 , 패스워드 모든 변경를 저장하도록한다.

## 도메인 모델

### 회원 애그리거트

### 회원 (Member)

#### 속성

- `id` : `Long`
- `email` : `String`
- `password` : `Password`
- `nickname` : `Nickname`
- `status` : `회원 상태`
- `registeredAt` : 등록 일시
- `activatedAt` : 등록 완료 일시
- `deactivatedAt` : 탈퇴 일시

#### 행위

- `static register()`: 회원 등록 :email, nickname, password, status, passwordEncoder
- `activate()`: 등록을 완료 시킨다.
- `deactivate()`: 탈퇴시킨다.
- `verifyPassword()` : 비밀번호를 검증한다.
- `changePassword()` : 비밀번호를 변경한다.

#### 규칙

- 회원 생성 후 상태는 등록 대기
- 일정조건을 만족하면 등록 완료가 된다.
- 등록 완료 상태에서는 탈퇴할 수 있다.
- 등록 대기 상태에서만 등록 완료가 될 수 있다.
- 회원의 비밀번호는 해시를 만들어서 저장한다.
- 등록 완료 상태에서만 회원 정보를 수정할 수 있다.

### 예매

### 결제

### 관리자

### 대기열

### 좌석
